<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회원정보 수정</title>
    <!-- <link rel="stylesheet" href="changeInfo.css"> -->
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
</head>
<body>
    <div class="container">
        <h2>회원정보 수정</h2>
        <form action="/user/changeInfo" method="post">
            <div class="section">
                <h3>아이디/비밀번호</h3>
                <div class="input-group">
                    <label for="userid">아이디</label>
                    <input name="user_id" type="text" id="userid" value="{{user.user_id}}" disabled>
                </div>
                <div class="input-group">
                    <label for="password">비밀번호</label>
                    <input name="pw" type="password" id="password" placeholder="새 비밀번호를 입력하세요">
                </div>
                <div class="input-group">
                    <label for="password-confirm">비밀번호 확인</label>
                    <input type="password" id="password-confirm" placeholder="새 비밀번호를 확인하세요">
                </div>
            </div>
            <div class="section">
                <h3>내 정보 입력</h3>
                <div class="input-group">
                    <label for="name">이름</label>
                    <input name="name" type="text" id="name" value="{{user.name}}" placeholder="이름을 입력하세요">
                </div>
                <div class="input-group">
                    <label for="nick">별명</label>
                    <input name="nick" type="text" id="nick" value="{{user.nick}}" placeholder="새 닉네임을 입력하세요">
                </div>
                <div class="input-group">
                    <label for="email">이메일</label>
                    <input name="email" type="email" id="email" value="{{user.email}}" placeholder="새 이메일을 입력하세요">
                </div>
                <div class="input-group">
                    <label for="address">주소</label>
                    <input type="text" id="sample4_postcode" class="rgst_inputBox" value="{{user.addr_code}}" placeholder="우편번호" name="addr_code">
                    <input type="button" id="searchAddrButton" value="우편번호 찾기" class="searchAddr"><br>
                    <input type="text" id="sample4_jibunAddress" class="rgst_inputBox" value="{{user.addr_jibun}}" placeholder="도로명주소" name="addr_jibun">
                    <input type="text" id="sample4_detailAddress" class="rgst_inputBox" value="{{user.addr_detail}}" placeholder="상세주소" name="addr_detail"><br>
                </div>
                <div class="input-group">
                    <label for="phone">휴대전화 번호</label>
                    <input name="tel" type="tel" id="phone" value="{{user.tel}}">
                </div>
                <div class="input-group">
                    <label for="wd_account">계좌</label>
                    <input name="wd_account" type="text" id="wd_account" value="{{user.wd_account}}">
                </div>
                <div class="input-group">
                    <label for="ba_number">계좌번호</label>
                    <input name="ba_number" type="text" id="ba_number" value="{{user.ba_number}}">
                </div>
            </div>
            <div class="input-btn">
                <input type="submit" class="button" value="정보 수정">
                <a href="/user/myPage" class="button">취소</a>
            </div>
        </form>
    </div>
    <script>
        document.getElementById('searchAddrButton').addEventListener('click', sample4_execDaumPostcode);
        
        function sample4_execDaumPostcode() {
            var element_wrap = document.createElement('div'); // 팝업을 감쌀 div 생성
            document.body.appendChild(element_wrap); // body에 div 추가
            
            var currentPostcode = new daum.Postcode({
                oncomplete: function (data) {
                    // 지번 주소를 표시하는 코드
                    var jibunAddr = data.jibunAddress; // 지번 주소 변수
                    var extraJibunAddr = ''; // 참고 항목 변수

                    // 법정동명이 있을 경우 추가한다.
                    if (data.bname !== '' && /[동|로|가]$/g.test(data.bname)) {
                        extraJibunAddr += data.bname;
                    }
                    // 건물명이 있고, 공동주택일 경우 추가한다.
                    if (data.buildingName !== '' && data.apartment === 'Y') {
                        extraJibunAddr += (extraJibunAddr !== '' ? ', ' + data.buildingName : data.buildingName);
                    }
                    // 표시할 참고항목이 있을 경우, 괄호까지 추가한 최종 문자열을 만든다.
                    if (extraJibunAddr !== '') {
                        extraJibunAddr = ' (' + extraJibunAddr + ')';
                    }
                    
                    // 우편번호와 지번 주소 정보를 해당 필드에 넣는다.
                    document.getElementById('sample4_postcode').value = data.zonecode;
                    document.getElementById("sample4_jibunAddress").value = jibunAddr + extraJibunAddr;
                    
                    // 팝업을 감싼 div 제거
                    document.body.removeChild(element_wrap);
                },
                container: element_wrap
            });
            
            currentPostcode.open();
        }
    </script>
</body>
</html>
